[
    {
        "title": "Bitsadmin Download",
        "id": "d059842b-6b9d-4ed1-b5c3-5b89143c6ede",
        "status": "experimental",
        "description": "Detects usage of bitsadmin downloading a file",
        "tags": [
            "attack.defense_evasion",
            "attack.persistence",
            "attack.t1197",
            "attack.s0190"
        ],
        "author": "Michael Haag",
        "falsepositives": [
            "Some legitimate apps use this, but limited."
        ],
        "level": "medium",
        "rule": [
            "SELECT * FROM logs WHERE (Channel = 'Microsoft-Windows-Sysmon/Operational' AND EventID = '1' AND ((Image LIKE '%\\\\bitsadmin.exe' ESCAPE '\\' AND CommandLine LIKE '% /transfer %' ESCAPE '\\') OR CommandLine LIKE '%copy bitsadmin.exe%' ESCAPE '\\'))"
        ],
        "filename": "astaroth-bits.yml"
    },
    {
        "title": "ExtExport.exe DLL Side Loading",
        "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
        "status": "experimental",
        "description": "Detects ExtExport.exe with arguments being executed. Could indicate a DLL Side-Loading attempt.",
        "tags": [
            "attack.execution",
            "attack.defense_evasion",
            "attack.t1059",
            "attack.t1073"
        ],
        "author": "Martin, Anartz",
        "falsepositives": [
            "Depending on the estate activity. They should be rare."
        ],
        "level": "medium",
        "rule": [
            "SELECT * FROM logs WHERE (Channel = 'Microsoft-Windows-Sysmon/Operational' AND (EventID = '1' AND (Image LIKE '%\\\\extexport.exe' ESCAPE '\\')) AND NOT ((CommandLine LIKE '^[Cc]\\\\:\\\\[Pp]rogram\\\\ [Ff]iles(\\\\ \\\\([Xx]86\\\\))_\\\\[Ii]nternet\\\\ [Ee]xplorer\\\\[Ee]xt[Ee]xport\\\\.exe$' ESCAPE '\\')))"
        ],
        "filename": "astaroth-extexport.yml"
    },
    {
        "title": "Add StartUp Key to Explorer Shell Folders (v2)",
        "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
        "status": "experimental",
        "description": "Add StartUp Key to Explorer Shell Folders (v2)",
        "level": "critical",
        "rule": [
            "SELECT * FROM logs WHERE (Channel = 'Microsoft-Windows-Sysmon/Operational' AND EventID = '13' AND TargetObject LIKE '%\\\\CurrentVersion\\\\Explorer\\\\Shell Folders\\\\StartUp' ESCAPE '\\' AND Details LIKE '%\\\\launcher.lnk' ESCAPE '\\')"
        ],
        "filename": "astaroth-reg-v2.yml"
    },
    {
        "title": "Add StartUp Key to Explorer Shell Folders",
        "status": "experimental",
        "description": "Add StartUp Key to Explorer Shell Folders",
        "author": "Based on Joe Security Sigma rules",
        "id": 200067,
        "level": "critical",
        "rule": [
            "SELECT * FROM logs WHERE (Channel = 'Microsoft-Windows-Sysmon/Operational' AND EventID = '1' AND Image LIKE '%\\\\reg.exe' ESCAPE '\\' AND CommandLine LIKE '%\\\\CurrentVersion\\\\Explorer\\\\Shell Folders%StartUp%' ESCAPE '\\' AND CommandLine LIKE '%launcher.lnk%' ESCAPE '\\')"
        ],
        "filename": "astaroth-reg.yml"
    },
    {
        "title": "Drops script at startup location",
        "status": "experimental",
        "description": "Drops script at startup location",
        "author": "Joe Security",
        "id": 200071,
        "level": "critical",
        "rule": [
            "SELECT * FROM logs WHERE (Channel = 'Microsoft-Windows-Sysmon/Operational' AND EventID = '11' AND (TargetFilename LIKE '%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\%.vbs%' ESCAPE '\\' OR TargetFilename LIKE '%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\%.js%' ESCAPE '\\' OR TargetFilename LIKE '%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\%.jse%' ESCAPE '\\' OR TargetFilename LIKE '%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\%.bat%' ESCAPE '\\' OR TargetFilename LIKE '%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\%.url%' ESCAPE '\\' OR TargetFilename LIKE '%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\%.cmd%' ESCAPE '\\' OR TargetFilename LIKE '%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\%.hta%' ESCAPE '\\' OR TargetFilename LIKE '%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\%.ps1%' ESCAPE '\\' OR TargetFilename LIKE '%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\%.lnk%' ESCAPE '\\'))"
        ],
        "filename": "astaroth-startup.yml"
    }
]
